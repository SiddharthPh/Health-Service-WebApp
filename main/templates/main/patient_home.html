{% extends 'main/base.html' %}
{% block content %}
<!-- <button type="button" class="btn btn-primary">Patients_Portal</button>
<button type="button" class="btn btn-secondary">Physicians_Portal</button>
<button type="button" class="btn btn-success">Doctor_Portal</button> -->
  <!-- Font Awesome -->
<!-- <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css"> -->
<!-- Google Fonts -->
<!-- <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"> -->
<!-- Bootstrap core CSS -->
<!-- <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/css/bootstrap.min.css" rel="stylesheet"> -->
<!-- Material Design Bootstrap -->
<!-- <link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" rel="stylesheet"> -->

<style>

.dropbtn {
  background-color: #4CAF50;
  color: white;
  padding: 16px;
  font-size: 16px;
  border: none;
  cursor: pointer;
}

/* Dropdown button on hover & focus */
.dropbtn:hover, .dropbtn:focus {
  background-color: #3e8e41;
}

/* The search field */
#myInput {
  box-sizing: border-box;
  /* background-image: url('searchicon.png'); */
  background-position: 14px 12px;
  background-repeat: no-repeat;
  font-size: 16px;
  padding: 14px 20px 12px 45px;
  border: none;
  border-bottom: 1px solid #ddd;
}

/* The search field when it gets focus/clicked on */
#myInput:focus {outline: 3px solid #ddd;}

/* The container <div> - needed to position the dropdown content */
.dropdown {
  position: relative;
  display: inline-block;
}

/* Dropdown Content (Hidden by Default) */
.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f6f6f6;
  min-width: 230px;
  border: 1px solid #ddd;
  z-index: 1;
  overflow: auto;
}

/* Links inside the dropdown */
.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

/* Change color of dropdown links on hover */
.dropdown-content a:hover {background-color: #f1f1f1}

/* Show the dropdown menu (use JS to add this class to the .dropdown-content container when the user clicks on the dropdown button) */
.show {display:block;}
  body {
  font-size: .875rem;
}

.feather {
  width: 16px;
  height: 16px;
  vertical-align: text-bottom;
}

/*
 * Sidebar
 */

.sidebar {
  position: fixed;
  top: 0;
  bottom: 0;
  left: 0;
  z-index: 100; /* Behind the navbar */
  padding: 48px 0 0; /* Height of navbar */
  box-shadow: inset -1px 0 0 rgba(0, 0, 0, .1);
}

.sidebar-sticky {
  position: relative;
  top: 0;
  height: calc(100vh - 48px);
  padding-top: .5rem;
  overflow-x: hidden;
  overflow-y: auto; /* Scrollable contents if viewport is shorter than content. */
}

@supports ((position: -webkit-sticky) or (position: sticky)) {
  .sidebar-sticky {
    position: -webkit-sticky;
    position: sticky;
  }
}

.sidebar .nav-link {
  font-weight: 500;
  color: #333;
}

.sidebar .nav-link .feather {
  margin-right: 4px;
  color: #999;
}

.sidebar .nav-link.active {
  color: #007bff;
}

.sidebar .nav-link:hover .feather,
.sidebar .nav-link.active .feather {
  color: inherit;
}

.sidebar-heading {
  font-size: .75rem;
  text-transform: uppercase;
}

/*
 * Content
 */

[role="main"] {
  padding-top: 48px; /* Space for fixed navbar */
}

/*
 * Navbar
 */

.navbar-brand {
  padding-top: .75rem;
  padding-bottom: .75rem;
  font-size: 1rem;
  background-color: rgba(0, 0, 0, .25);
  box-shadow: inset -1px 0 0 rgba(0, 0, 0, .25);
}

.navbar .form-control {
  padding: .75rem 1rem;
  border-width: 0;
  border-radius: 0;
}

.form-control-dark {
  color: #fff;
  background-color: rgba(255, 255, 255, .1);
  border-color: rgba(255, 255, 255, .1);
}

.form-control-dark:focus {
  border-color: transparent;
  box-shadow: 0 0 0 3px rgba(255, 255, 255, .25);
}

.sticky {
  position: -webkit-sticky;
  position: sticky;
  top: 0;
  padding: 50px;
  font-size: 20px;
}

/* div.container-dropdown{
  overflow: scroll;
} */
</style>
<!-- <div class="container-fluid">
  <div class="row">
    <nav class="col-md-2 d-none d-md-block bg-light sidebar">
      <div class="sidebar-sticky">
        <ul class="nav flex-column">
          <li class="nav-item">
            <a class="nav-link active" href="#">
              <span data-feather="home"></span>
              Dashboard <span class="sr-only">(current)</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="file"></span>
              Orders
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="shopping-cart"></span>
              Products
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="users"></span>
              Customers
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="bar-chart-2"></span>
              Reports
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="layers"></span>
              Integrations
            </a>
          </li>
        </ul>

        <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
          <span>Saved reports</span>
          <a class="d-flex align-items-center text-muted" href="#">
            <span data-feather="plus-circle"></span>
          </a>
        </h6>
        <ul class="nav flex-column mb-2">
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="file-text"></span>
              Current month
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="file-text"></span>
              Last quarter
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="file-text"></span>
              Social engagement
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="file-text"></span>
              Year-end sale
            </a>
          </li>
        </ul>
      </div>
    </nav>
  </div>
</div> -->

<div class="container-fluid">
  <div class="row">
    <nav class="col-md-2 d-none d-md-block bg-light sidebar">
      <div class="sidebar-sticky">
      <img src="../../../media/patient_pics/default.jpg" class="ronded-circle account-img" alt="Person" style="width:70%; margin-left: 30px;margin-top: 50px;">
      <h5 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
        <span style="text-align:center;">Name:  {{patient_name}}</span>
        <a class="d-flex align-items-center text-muted" href="#">
          <span data-feather="plus-circle"></span>
        </a>
      </h5>

        
        <ul class="nav flex-column mb-2">
          <!-- <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="file-text"></span>
              Current month
            </a>
          </li> -->
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="file-text"></span>
              Email:  {{patient_email}}
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="file-text">City:  {{patient_address}}</span>
              
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="file-text"></span>
              Phone:  {{patient_phone}}
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="file-text"></span>
              Height:  {{patient_height}}cms
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="file-text"></span>
              Weight:  {{patient_weight}}kgs
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <span data-feather="file-text"></span>
              Gender:  {{patient_gender}}
            </a>
          </li>
        </ul>
      </div>
    </nav>
  </div>
</div>
<main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-4" >
  <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom" style="margin-top: 50px;">
    <h1 class="h2">Health Summary</h1>
    <div class="btn-toolbar mb-2 mb-md-0">
    </div>
  </div>

      
  <div class="row">
    <div class="col-sm-6">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Temperature Reading</h5>
          <ul class="list-group list-group-flush">
            <li class="list-group-item" id="drugallergies"></li>
            <li class="list-group-item" id="all_illness"></li>
            <li class="list-group-item" id="all_operations"></li>
            <li class="list-group-item" id="current_medication"></li>
            </ul>
        </div>
      </div>
    </div>
    <div class="col-sm-6">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Blood Pressure Reading</h5>
            <ul class="list-group list-group-flush">
              <li class="list-group-item" id="drugallergies"></li>
              <li class="list-group-item" id="all_illness"></li>
              <li class="list-group-item" id="all_operations"></li>
              <li class="list-group-item" id="current_medication"></li>
              </ul>
        </div>
      </div>
    </div>
  </div>  
  <!-- Layout -->
  <!-- <div class="container">
    <h4 style="font-weight: 600;margin: 3rem 0rem;">Office Bearers</h4>
    <div class="row">
      <div class="col s12 m6 l4">
        <div class="card hoverable office">
          <div class="card-image" >
            <img src="images/pramodh.jpeg">
            <span class="card-title" style="font-weight: 500;">Sri Pramodh</span>
          </div>
          <div class="card-content">
            <p><b style="font-size: 1.2rem;">Vice President (UG)</b><br>PhD student, Dept. of CS <br>Stony Brook University, NY</p>
          </div>          
        </div>
      </div>
      <div class="col s12 m6 l4">
        <div class="card hoverable office">
          <div class="card-image" >
            <img src="images/govind.jpg">
            <span class="card-title" style="font-weight: 500;">Govind Kumar</span>
          </div>
          <div class="card-content">
            <p><b style="font-size: 1.2rem;">President</b><br>Software Engineer <br>Cunomial, Bangalore</p>
          </div>          
        </div>
      </div>
      <div class="col s12 m6 l4">
        <div class="card hoverable office">
          <div class="card-image" >
            <img src="images/pramodh.jpeg">
            <span class="card-title" style="font-weight: 500;">Sri Pramodh</span>
          </div>
          <div class="card-content">
            <p><b style="font-size: 1.2rem;">Vice President (UG)</b> <br>PhD student, Dept. of CS <br>Stony Brook University, NY</p>
          </div>          
        </div>
      </div>
      <div class="col s12 m6 l4">
        <div class="card hoverable office">
          <div class="card-image" >
            <img src="images/shubham.jpeg">
            <span class="card-title" style="font-weight: 500;">Shubham Giri</span>
          </div>
          <div class="card-content">
            <p><b style="font-size: 1.2rem;">Executive Member - PG</b><br>PhD student, Dept. of ME <br>IIT Bombay, India</p>
          </div>          
        </div>
      </div>
      <div class="col s12 m6 l4">
        <div class="card hoverable office">
          <div class="card-image" >
            <img src="images/Suyash.JPG"> <span class="card-title" style="font-weight: 500;">Dr. Suyash Kandele</span>
          </div>
          <div class="card-content">
            <p><b style="font-size: 1.2rem;">Vice President PG</b> <br> Research Engineer <br>Redpine Signals, Hyderabad</p>
          </div>          
        </div>
      </div>
      <div class="col s12 m6 l4">
        <div class="card hoverable office">
          <div class="card-image" >
            <img src="images/govind.jpg">
            <span class="card-title" style="font-weight: 500;">Govind Kumar</span>
          </div>
          <div class="card-content">
            <p><span style="font-size: 1.2rem;font-weight: 700;text-align: center;margin:0rem auto;">President</span><br>Software Engineer <br>Cunomial, Bangalore</p>
          </div>          
        </div>
      </div>
    </div>
  </div>
   -->

</div>
<div class="row">
  <div class="col-md-6 order-md-1" style="margin-bottom: 100px;margin-top: 50px;">
    <div class="card">
  <h5 class="card-header">Appointment Form</h5>
  <div class="card-body">
  <form class="needs-validation" novalidate action="{% url 'appointment' %}" method="POST" >
    {% csrf_token %}
    <div class="row">
      <div class="col-md-5 mb-1">
        <label for="firstName">Full name</label>
        <input type="text" class="form-control" id="fullName" name="fullName" placeholder="" value="" required>
        <div class="invalid-feedback">
          Valid full name is required.
        </div>
      </div>
    </div>

    <div class="mb-3">
      <label for="username">Email</label>
      <div class="input-group">
        <div class="input-group-prepend">
          <span class="input-group-text">@</span>
        </div>
        <input type="text" class="form-control" id="username" name="email" placeholder="Username" required>
        <div class="invalid-feedback" style="width: 100%;">
          Your username is required.
        </div>
      </div>
      
    </div>
    <div class="form-group">
      <label for="inputState">Schedule Time</label>
      <select id="schedule" name="schedule_time" class="form-control" required>
        <option selected>9AM-10AM</option>
        <option selected>11AM-12PM</option>
        <option selected>1PM-2PM</option>
        <option selected>3PM-4PM</option>
      </select>
    </div>
    <div class="form-group">
      <label for="scheduledate">Date:</label>
      <input type="date" id="date" name="schedule_date">
    </div>

    <div class="form-group">
      <label for="inputState">Doctors</label>
      <select id="doctors" name="doctors" class="form-control" required>
        {% for doctor in doctors %}
        <option value="{{ doctor.email }}">{{ doctor.name }}[{{doctor.profession}}]({{doctor.email}})</option>
        {% endfor %}
      </select>
    </div>
    <div class="form-group">
      <label for="Message">Message:</label>
      <textarea class="form-control" id="exampleFormControlTextarea1" name="message" rows="3"></textarea>
    </div>
    

    <hr class="mb-4">
    <button class="btn btn-primary btn-lg btn-block" type="submit">Continue to Review</button>
  </form>
  </div>
  </div>
</div>
  <div class="col-md-6 order-md-2" style="margin-bottom: 100px;margin-top: 50px;">
    <div class="card">
      <h5 class="card-header">Medical History</h5>
      {% if medical_history_obj %}
      <div class="card-body">
        <div class="row">
          <div class="col-md-5 mb-1">
            <input type="hidden" name="patient_email" value={{patient_email}}>

            <label for="drug_allergies">Drug Allergies</label>
            <textarea class="form-control" id="drugallergies" name="drugallergies" rows="3">{{medical_history_obj.drugallergies}}</textarea>
          </div>
    
          <div class="col-md-5 mb-1">
            <label for="drug_allergies">All Illness</label>
            <textarea class="form-control" id="allillness" name="allillness" rows="3">{{medical_history_obj.all_illness}}</textarea>
          </div>
          <div class="col-md-5 mb-1">
            <label for="drug_allergies">All Operations</label>
            <textarea class="form-control" id="alloperations" name="alloperations" rows="3">{{medical_history_obj.all_operations}}</textarea>
          </div>
          <div class="col-md-5 mb-1">
            <label for="drug_allergies">Current Medication</label>
            <textarea class="form-control" id="current_medication" name="current_medication" rows="3">{{medical_history_obj.current_medication}}</textarea>
          </div>        
        </div>
      </div>
      {% else %}
      <div class="card-body">
        <form class="needs-validation" novalidate action="{% url 'medical_history_check' %}" method="POST" >
          {% csrf_token %}
          <div class="row">
              <input type="hidden" name="patient_email" value={{patient_email}}>
              <div class="col-md-5 mb-1">
              <label for="drug_allergies">Drug Allergies</label>
              <textarea class="form-control" id="drugallergies" name="drugallergies" rows="3"></textarea>
            </div>
      
            <div class="col-md-5 mb-1">
              <label for="drug_allergies">All Illness</label>
              <textarea class="form-control" id="allillness" name="allillness" rows="3"></textarea>
            </div>
            <div class="col-md-5 mb-1">
              <label for="drug_allergies">All Operations</label>
              <textarea class="form-control" id="alloperations" name="alloperations" rows="3"></textarea>
            </div>
            <div class="col-md-5 mb-1">
              <label for="drug_allergies">Current Medication</label>
              <textarea class="form-control" id="current_medication" name="current_medication" rows="3"></textarea>
            </div>
            <button class="btn btn-primary btn-lg btn-block" type="submit">Submit</button>

        </form>
        
      </div>
        {% endif %}
      </div>
  </div>
</div>

<!-- 
<div class="container">
  <br>
  <div class="text-center"> 
    <h3>
        Identify possible conditions and treatment related to your symptoms.
    </h3><br>
          <button onclick="Functionshow()" class="btn btn-primary dropdown-toggle">Add symptoms</button>
  </div>
</div >

<div id="myDropdown" class="drop-content">

      <div id="searchbardiv" class="searchbardiv">    
    
          <input id="searchbar" class="searchbar" onkeyup="search_symptoms()" type="text"
            name="search" placeholder=" Search symptoms.. "> <br>
      </div> 

      <div class="container-dropdown" id="container-dropdown" style="overflow: scroll;">
          {% for symptom in symptoms %}
          
          <a class="dropdown-item" onclick="Functionsymptoms(this.textContent)" style="overflow: scroll;">{{symptom}}</a>
          
          {% endfor %}
      </div>
</div>
  
<br><br>
<div class="text-center">
      <div class="card" id= "symptoms-box">
  
    {% csrf_token %}
          <div class="card-header">Symptoms list -</div>
                  <div class="card-body" id="sympbox" >
                  </div>
                        <br>
                        <div class="card-footer">
                              <button id="predict" class="btn btn-success">Predict</button>
                        </div>
           </div>
      </div>
</div>

<br>

<div id="resultdiv" style="display: none;" >
      <div class="text-center">
            <div class="card" id="predicted-data">
                  <div>
                          <span class="diseasefield" >Patient name : {{ user.patient.name }}</span>
                          <span class="diseasefield" >&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp Age : {{ user.patient.age }} </span>
                  </div>
                  <span class="diseasefield" >predicted disease is : </span><span class="diseasefield" id="diseasefield" style="color: #092700; text-shadow: 2px 2px 4px rgb(36, 255, 45);"></span> <br>
                  <br>
                  <span class="diseasefield">confidence score of :  </span>
                  <span>
                        <div class="progress" style="display: inline-block;width:140px">
                            <div id="percentage" class="progress-bar" style="width: 0%">0%
                            </div>
                        </div>
                  </span>

                  </div>
            </div>

      <div class="text-center mt-4 mb-4"> 
            <button class="btn btn-outline-success">
                  <a id="href" href="https://www.google.com/search?q=anuj" target="_blank" rel="noopener noreferrer">Click here to know more about &nbsp 
                  <span id="diseasesearch" style="color: crimson;"></span></a>
            </button>
      </div>
        <br><br>

      <div class="text-center">
        <h4>This tool does not provide medical advice. It is intended for informational purposes only.
        </h4><h4>It is not a substitute for professional medical advice, diagnosis or treatment. 
        </h4>
      <br><br>

      </div>


<div class="mx-auto text-center " style="width:350px">

   
      <div >  <form action="consult_a_doctor" method="GET">
          {% csrf_token %} 
          <button id="consultbtn" type="submit" class="btn btn-primary"> Consult a <span id="consultdoctor"  name="consultdoctor" > </span> doctor</button>
        </form>
      </div>
    

</div>

       

</div> -->
<div class="container">
  <div class="card">
    <div class="card-header">Disease Prediction</div>
  <div class="dropdown" style="margin-bottom: 300px;">
  <button onclick="myFunction()" class="dropbtn">Click this to add symptom</button>
  <div id="myDropdown" class="dropdown-content" style="overflow-y: scroll;height: 300px;">
    <input class="sticky" type="text" placeholder="Search for symptom" id="myInput" onkeyup="filterFunction()">
    <!-- <select class="js-example-basic-single" name="symptom" onclick="check_disease(this.value)"> -->
    {% for symptom in symptoms %}
    <a  onclick="check_disease(this.id)" id="{{symptom}}">{{symptom}}</a>
    <!-- <option value="{{symptom}}">{{symptom}}</option> -->

    {% endfor %}
  </div>
  <div class="card-content">
    <br><br>
    <li id="disease"></li>
  </div>
</div>
</div>
</div>

 <!-- <div class="card">
  <select class="js-example-basic-single" name="symptom">
    <input placeholder="This ">
    {% for symptom in symptoms %}
    <option>{{symptom}}</option>
    {% endfor %}
  </select>
</div> -->
  </div>
  </main>
  <script src="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/feather.min.js" integrity="sha384-uO3SXW5IuS1ZpFPKugNNWqTZRRglnUJK6UAZ/gxOX80nxEkN9NcGZTftn6RzhGWE" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js" integrity="sha384-zNy6FEbO50N+Cg5wap8IKA4M/ZnLJgzc6w2NqACZaK0u0FXfOWRRJOnQtpZun8ha" crossorigin="anonymous"></script>
  <!-- <script src="../../static/main/js/dashboard.js"></script> -->
  <script type="text/javascript" src="http://code.jquery.com/jquery-1.10.0.min.js"></script>

  <!-- <script>
    $(document).ready(function(){
      $("#viewmore").click(function(){
        $("#myModal").modal();
      });
    });
    </script> -->
    <script>

function getCookie(name)
      {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            // Does this cookie string begin with the name we want?
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}
var csrftoken = getCookie('csrftoken');



      function myFunction() {
  document.getElementById("myDropdown").classList.toggle("show");
}

function filterFunction() {
  var input, filter, ul, li, a, i;
  input = document.getElementById("myInput");
  filter = input.value.toLowerCase();
  div = document.getElementById("myDropdown");
  a = div.getElementsByTagName("option");
  for (i = 0; i < a.length; i++) {
    txtValue = a[i].textContent || a[i].innerText;
    if (txtValue.toLowerCase().indexOf(filter) > -1) {
      a[i].style.display = "";
    } else {
      a[i].style.display = "none";
    }
  }
}


      function check_disease(svalue){
        document.getElementById("myDropdown").classList.toggle("show");
        var xhttp;
        data=svalue;
        console.log(data)
        data=JSON.stringify({disease:data})
        console.log(data)
        xhttp=new XMLHttpRequest()
        xhttp.onreadystatechange=function()
        {
          if(this.readyState==4 && this.status==200)
          {
            // console.log("success")
            disease=this.responseText
            var obj=JSON.parse(disease)
            console.log(obj)
            document.getElementById("disease").innerHTML="Disease might be  "+obj['disease']
            // document.getElementById("rr").innerHTML="RR:  "+obj['rr']+" BPM"
            // document.getElementById("Heart_rate").innerHTML="Heart_rate:  "+obj['Heart_rate']+" BPM"
            // document.getElementById("rMSSD").innerHTML="rMSSD:  "+obj['RMSSD']+" ms"
            // document.getElementById("NNxx").innerHTML="NNxx:  "+obj['NNxx']+" ms"
            // document.getElementById("pNNxx").innerHTML="pNNxx:  "+obj['pNNxx']+" ms"
            // document.getElementById("LF").innerHTML="LF:  "+obj['LF']+" Hz"
            // document.getElementById("HF").innerHTML="HF:  "+obj['HF']+" Hz"
            // document.getElementById("LF_HF").innerHTML="LF/HF:  "+obj['LF_HF']+" ms"


          }
        };
        xhttp.open("POST",'checkdisease_drive',true);
        xhttp.setRequestHeader('X-CSRFToken', csrftoken);
        xhttp.send(data);
      }

      $(document).ready(function() {
    $('.js-example-basic-single').select2();
});
    </script>
    <script>
      function Functionshow() {
  
  document.getElementById("searchbar").value = '';
  document.getElementById("myDropdown").classList.toggle("show");
   search_symptoms();
  
}


// Close the dropdown menu if the user clicks outside of it
window.onclick = function(event) {
  if (!event.target.matches('.btn')) {
    if (!event.target.matches('.searchbardiv')){
      if (!event.target.matches('.searchbar')){

    var dropdowns = document.getElementsByClassName("drop-content");
    var i;
    for (i = 0; i < dropdowns.length; i++) {
      
      var openDropdown = dropdowns[i];
      if (openDropdown.classList.contains('show')) {
        openDropdown.classList.remove('show');
      }
    }
  }
}
}
}

  function Functionsymptoms(name) {
    var newItem = document.createElement("TEXTAREA");
    newItem.innerText = name;
    newItem.setAttribute("id","symptoms");
    
    newItem.setAttribute("class","symptoms");
    document.getElementById("sympbox").appendChild(newItem);
    
  }

 
  //var elements = document.getElementsByClassName("symptoms");


  function search_symptoms() { 
    let input = document.getElementById('searchbar').value 
    input=input.toLowerCase(); 
    let x = document.getElementsByClassName('dropdown-item'); 
      console.log("search")
    for (i = 0; i < x.length; i++) {  
        if (!x[i].innerHTML.toLowerCase().includes(input)) { 
            x[i].style.display="none"; 
        } 
        else { 
            x[i].style.display="inline-block";                  
        } 
    } 
} 


$(document).ready( function(){


$("#predict").click(function () {
  event.preventDefault();

  var symptoms = document.getElementsByClassName("symptoms");
  var noofsym = symptoms.length;
  var symlist=[];

  if(noofsym == 0){
     alert(" please add some symptoms ");
  }

  else {

  for(i=0;i<symptoms.length;i++){
    symlist[i]=symptoms[i].value;
  }
  


  $("#resultdiv").show("slow");
  $('html,body').animate({
    scrollTop: $("#resultdiv").offset().top},
    'slow');
       



  $.ajax({
      url: 'checkdisease',
      type: "POST",
      data: { "noofsym" : noofsym,
              "symptoms" :symlist,
              csrfmiddlewaretoken : $('input[name=csrfmiddlewaretoken]').val()
      },
      dataType: 'json',

      success: function (data) {
        document.getElementById('diseasefield').innerText = data["predicteddisease"];
        document.getElementById('percentage').innerText = data["confidencescore"]+"%";
        percent=data["confidencescore"];
        disease=data["predicteddisease"];

        $('#percentage').css('width', percent + "%");

        document.getElementById('diseasesearch').innerText = data["predicteddisease"];

        $("#href").attr("href","https://www.google.com/search?q="+ disease +"");

        
        document.getElementById('consultdoctor').innerText = data["consultdoctor"];

      }
      
    });

  }

  });



});

    </script>
  



{% endblock %}